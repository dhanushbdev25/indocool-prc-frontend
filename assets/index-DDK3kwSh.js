import{j as e,I as o,a2 as t,X as i,bn as s,aM as n,bh as r,bK as a,w as l,bk as c,bl as d,a4 as x,a5 as p,d as h,y as m,Z as u,aN as f,bj as j,J as g,M as b,Y as C,a8 as y,ah as v,bp as I,aU as S,m as w,bq as z,ad as k,ae as A,af as T,ag as N}from"./mui-vendor-ThRJoe5u.js";import{f as W,r as E}from"./react-vendor-jVbyDP5c.js";import{T as V,C as P}from"./CatalystTableSkeleton-BjboBL1o.js";import{m as M,n as L}from"./index-CgzbgTp3.js";import"./table-vendor-Bx02c7my.js";import"./auth-vendor-BOyMHjHL.js";import"./state-vendor-BxbV2bHq.js";import"./utils-vendor-S0KZLiBE.js";import"./form-vendor-DG-ZRlco.js";import"./ui-vendor-DL_b4SbO.js";const D=()=>{const n=W();return e.jsx(o,{sx:{mb:4},children:e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1},children:[e.jsxs(o,{children:[e.jsx(t,{variant:"h3",sx:{fontWeight:600,color:"#333",mb:1,fontSize:"2rem"},children:"Inspection Master"}),e.jsx(t,{variant:"body1",sx:{color:"#666",fontSize:"1rem",fontWeight:400},children:"Manage quality inspection procedures and parameter configurations"})]}),e.jsx(i,{variant:"contained",startIcon:e.jsx(s,{}),onClick:()=>{n("/inspection-master/create-inspection")},sx:{backgroundColor:"#1976d2",color:"white",borderRadius:"8px",px:3,py:1.5,textTransform:"none",fontSize:"0.875rem",fontWeight:500,"&:hover":{backgroundColor:"#1565c0"}},children:"Add Inspection"})]})})},q=({headerData:i})=>{const s=[{title:"Total Inspections",value:i.ACTIVE+i.NEW+i.INACTIVE,subtitle:`${i.ACTIVE} active inspections`,icon:e.jsx(n,{sx:{color:"#666",fontSize:"1.5rem",opacity:.7}})},{title:"Active Inspections",value:i.ACTIVE,subtitle:"Currently in use",icon:e.jsx(r,{sx:{color:"#4caf50",fontSize:"1.5rem",opacity:.8}})},{title:"New Inspections",value:i.NEW,subtitle:"Recently created",icon:e.jsx(a,{sx:{color:"#2196f3",fontSize:"1.5rem",opacity:.8}})},{title:"Inactive Inspections",value:i.INACTIVE,subtitle:"Not in use",icon:e.jsx(l,{sx:{color:"#f44336",fontSize:"1.5rem",opacity:.8}})}];return e.jsx(o,{sx:{display:"flex",gap:3,mb:4},children:s.map((i,s)=>e.jsx(c,{sx:{flex:1,borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",backgroundColor:"white",transition:"transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 16px rgba(0,0,0,0.15)"}},children:e.jsx(d,{sx:{p:3,position:"relative"},children:e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(o,{children:[e.jsx(t,{variant:"body2",sx:{color:"#666",mb:1,fontSize:"0.875rem",fontWeight:500},children:i.title}),e.jsx(t,{variant:"h4",sx:{fontWeight:600,color:"#333",fontSize:"2rem",mb:.5},children:i.value}),e.jsx(t,{variant:"caption",sx:{color:"#999",fontSize:"0.75rem"},children:i.subtitle})]}),i.icon]})})},s))})},B=({onSearchChange:s,onFilterChange:r})=>{const[a,l]=E.useState("All Inspections"),[c,d]=E.useState("");return e.jsxs(o,{sx:{backgroundColor:"white",borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsxs(o,{sx:{p:3,borderBottom:"1px solid #e0e0e0"},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(n,{sx:{color:"#666",mr:1,fontSize:"1.25rem"}}),e.jsx(t,{variant:"h5",sx:{fontWeight:600,color:"#333",fontSize:"1.25rem"},children:"Inspection Management"})]}),e.jsx(t,{variant:"body2",sx:{color:"#666",fontSize:"0.875rem"},children:"Manage quality inspection procedures and parameter configurations"})]}),e.jsxs(o,{sx:{p:3,display:"flex",gap:2,alignItems:"center"},children:[e.jsx(x,{placeholder:"Search by Inspection ID, name or type",variant:"outlined",size:"small",value:c,onChange:e=>{const o=e.target.value;d(o),s?.(o)},InputProps:{startAdornment:e.jsx(p,{position:"start",children:e.jsx(h,{sx:{color:"#999"}})})},sx:{flex:1,"& .MuiOutlinedInput-root":{borderRadius:"8px",backgroundColor:"#fafafa","& fieldset":{borderColor:"#e0e0e0"},"&:hover fieldset":{borderColor:"#ccc"},"&.Mui-focused fieldset":{borderColor:"#1976d2"}},"& .MuiInputBase-input":{fontSize:"0.875rem",color:"#666","&::placeholder":{color:"#999",opacity:1}}}}),e.jsx(m,{direction:"row",spacing:1,children:["All Inspections","ACTIVE","NEW","INACTIVE"].map(o=>e.jsx(i,{variant:a===o?"contained":"outlined",onClick:()=>(e=>{l(e),r?.(e)})(o),sx:{borderRadius:"8px",textTransform:"none",fontSize:"0.875rem",fontWeight:500,px:2,py:1,minWidth:"auto",...a===o?{backgroundColor:"#1976d2",color:"white","&:hover":{backgroundColor:"#1565c0"}}:{color:"#666",borderColor:"#e0e0e0","&:hover":{borderColor:"#ccc",backgroundColor:"#f5f5f5"}}},children:o},o))})]})]})},K=E.memo(({data:i,onActionClick:s,onEdit:n,onView:a})=>{const[l,c]=E.useState(null),[d,x]=E.useState(null),p=e=>{switch(e){case"ACTIVE":return"#4caf50";case"NEW":return"#2196f3";default:return"#9e9e9e"}},h=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),m=()=>{c(null),x(null)},k=E.useMemo(()=>[{accessorKey:"inspectionId",header:"Inspection ID",size:200,Cell:({row:i})=>e.jsxs(o,{children:[e.jsx(t,{variant:"body2",sx:{fontWeight:500,color:"#333",fontSize:"0.875rem"},children:i.original.inspectionId}),e.jsx(t,{variant:"caption",sx:{color:"#999",fontSize:"0.75rem",display:"block"},children:i.original.updatedAt?`Updated: ${h(i.original.updatedAt)}`:""}),e.jsx(u,{label:i.original.type,size:"small",icon:e.jsx(f,{sx:{fontSize:"0.75rem"}}),sx:{backgroundColor:"#e3f2fd",color:"#1976d2",fontSize:"0.625rem",height:"20px",mt:.5}})]})},{accessorKey:"inspectionName",header:"Inspection Name",size:250,Cell:({row:o})=>e.jsx(t,{variant:"body2",sx:{color:"#333",fontSize:"0.875rem",fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:o.original.inspectionName})},{accessorKey:"version",header:"Version",size:100,Cell:({row:o})=>e.jsxs(t,{variant:"body2",sx:{color:"#333",fontSize:"0.875rem",fontWeight:500},children:["v",o.original.version]})},{accessorKey:"ctqParameters",header:"CTQ Parameters",size:120,Cell:({row:t})=>e.jsx(o,{sx:{display:"flex",alignItems:"center"},children:e.jsx(u,{icon:e.jsx(j,{sx:{fontSize:"0.75rem"}}),label:t.original.ctqParameters,size:"small",sx:{backgroundColor:"#fff3e0",color:"#f57c00",fontSize:"0.625rem",height:"20px","& .MuiChip-icon":{color:"#f57c00"}}})})},{accessorKey:"totalParameters",header:"Total Parameters",size:120,Cell:({row:o})=>e.jsx(t,{variant:"body2",sx:{color:"#333",fontSize:"0.875rem",fontWeight:500},children:o.original.totalParameters})},{accessorKey:"createdAt",header:"Created",size:120,Cell:({row:o})=>e.jsx(t,{variant:"body2",sx:{color:"#333",fontSize:"0.875rem"},children:o.original.createdAt?h(o.original.createdAt):"-"})},{accessorKey:"status",header:"Status",size:120,Cell:({row:o})=>e.jsx(u,{icon:e.jsx(r,{sx:{fontSize:"0.875rem"}}),label:o.original.status,size:"small",sx:{backgroundColor:p(o.original.status),color:"white",fontSize:"0.75rem",height:"24px","& .MuiChip-icon":{color:"white"}}})},{id:"actions",header:"Actions",size:80,enableSorting:!1,Cell:({row:o})=>e.jsx(g,{size:"small",onClick:e=>((e,o)=>{c(e.currentTarget),x(o)})(e,o.original),children:e.jsx(b,{sx:{color:"#666"}})})}],[]);return e.jsxs(o,{sx:{mt:2},children:[e.jsx(V,{data:i,tableColumns:k}),e.jsx(C,{anchorEl:l,open:Boolean(l),onClose:m,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsxs(y,{onClick:()=>{d&&a&&a(d.id),m()},children:[e.jsx(v,{children:e.jsx(I,{fontSize:"small"})}),e.jsx(S,{children:"View"})]},"view"),e.jsxs(y,{onClick:()=>{d&&n&&n(d.id),m()},children:[e.jsx(v,{children:e.jsx(w,{fontSize:"small"})}),e.jsx(S,{children:"Edit"})]},"edit"),e.jsxs(y,{onClick:()=>{d&&s&&s(d.inspectionId,"delete"),m()},sx:{color:"error.main"},children:[e.jsx(v,{children:e.jsx(z,{fontSize:"small",color:"error"})}),e.jsx(S,{children:"Delete"})]},"delete")]})]})}),R=()=>{const s=W(),[n,r]=E.useState(""),[a,l]=E.useState("All Inspections"),[c,d]=E.useState(!1),[x,p]=E.useState(null),{data:h,isLoading:m,refetch:u}=M(),[f,{isLoading:j}]=L(),g=E.useMemo(()=>h?h.detail.map(e=>({...e.inspection,ctqParameters:e.inspectionParameters.filter(e=>e.ctq).length,totalParameters:e.inspectionParameters.length})):[],[h]),b=E.useMemo(()=>{let e=g;return"All Inspections"!==a&&(e=e.filter(e=>e.status===a)),n&&(e=e.filter(e=>e.inspectionId.toLowerCase().includes(n.toLowerCase())||e.inspectionName.toLowerCase().includes(n.toLowerCase())||e.type.toLowerCase().includes(n.toLowerCase()))),e},[g,a,n]),C=()=>{d(!1),p(null)};return m?e.jsxs(o,{sx:{p:3,backgroundColor:"#f5f5f5",minHeight:"100vh"},children:[e.jsx(D,{}),e.jsx(P,{})]}):e.jsxs(o,{sx:{p:3,backgroundColor:"#f5f5f5",minHeight:"100vh"},children:[e.jsx(D,{}),h&&e.jsx(q,{headerData:h.header}),e.jsx(B,{onSearchChange:e=>{r(e)},onFilterChange:e=>{l(e)}}),e.jsx(K,{data:b,onActionClick:(e,o)=>{if("delete"===o){const o=g.find(o=>o.inspectionId===e);o&&(p(o),d(!0))}},onEdit:e=>{s(`/inspection-master/edit-inspection/${e}`)},onView:e=>{s(`/inspection-master/view-inspection/${e}`)}}),e.jsxs(k,{open:c,onClose:C,maxWidth:"sm",fullWidth:!0,children:[e.jsx(A,{children:"Delete Inspection Task"}),e.jsx(T,{children:e.jsxs(t,{children:["Are you sure you want to delete the inspection task for ",e.jsx("strong",{children:x?.inspectionId}),"? This will set the status to INACTIVE and preserve all remaining data."]})}),e.jsxs(N,{children:[e.jsx(i,{onClick:C,disabled:j,children:"Cancel"}),e.jsx(i,{onClick:async()=>{if(x)try{const e=h?.detail.find(e=>e.inspection.id===x.id);if(e){const o={inspection:{id:x.id,version:e.inspection.version,status:"INACTIVE",inspectionName:e.inspection.inspectionName,inspectionId:e.inspection.inspectionId,type:e.inspection.type,isLatest:e.inspection.isLatest,showPartImages:e.inspection.showPartImages??!1,partImages:e.inspection.partImages??[],createdBy:e.inspection.createdBy,updatedBy:e.inspection.updatedBy},inspectionParameters:e.inspectionParameters.map(e=>({order:e.order,parameterName:e.parameterName,specification:e.specification,tolerance:e.tolerance,type:e.type,files:e.files||{},columns:e.columns.map(e=>({name:e.name,type:e.type,defaultValue:e.defaultValue||"",tolerance:e.tolerance||""})),role:e.role,ctq:e.ctq}))};await f(o).unwrap(),await u(),d(!1),p(null)}}catch(e){}},color:"error",variant:"contained",disabled:j,children:j?"Deleting...":"Delete Task"})]})]})]})};export{R as default};

import{j as e,I as s,a2 as t,X as o,bn as r,bz as a,bh as n,w as i,bk as l,bl as c,a4 as d,a5 as u,d as x,b3 as h,a6 as p,a7 as m,a8 as f,Z as j,bA as g,J as b,M as S,Y as C,ah as v,bp as y,aU as w,m as q,bq as z,ad as A,ae as I,af as T,ag as k}from"./mui-vendor-ThRJoe5u.js";import{f as V,r as M}from"./react-vendor-jVbyDP5c.js";import{T as L,C as N}from"./CatalystTableSkeleton-BjboBL1o.js";import{h as W,i as D}from"./index-CgzbgTp3.js";import"./table-vendor-Bx02c7my.js";import"./auth-vendor-BOyMHjHL.js";import"./state-vendor-BxbV2bHq.js";import"./utils-vendor-S0KZLiBE.js";import"./form-vendor-DG-ZRlco.js";import"./ui-vendor-DL_b4SbO.js";const E=()=>{const a=V();return e.jsx(s,{sx:{mb:4},children:e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1},children:[e.jsxs(s,{children:[e.jsx(t,{variant:"h3",sx:{fontWeight:600,color:"#333",mb:1,fontSize:"2rem"},children:"Process Sequence Master"}),e.jsx(t,{variant:"body1",sx:{color:"#666",fontSize:"1rem",fontWeight:400},children:"Manage and configure process sequences for production workflows"})]}),e.jsx(o,{variant:"contained",startIcon:e.jsx(r,{}),onClick:()=>{a("/sequence-master/create-sequence")},sx:{backgroundColor:"#1976d2",color:"white",borderRadius:"8px",px:3,py:1.5,textTransform:"none",fontSize:"0.875rem",fontWeight:500,"&:hover":{backgroundColor:"#1565c0"}},children:"Add Sequence"})]})})},F=({headerData:o})=>{const r=[{title:"Total Sequences",value:o.ACTIVE+o.INACTIVE,subtitle:`${o.ACTIVE} active sequences`,icon:e.jsx(a,{sx:{color:"#666",fontSize:"1.5rem",opacity:.7}})},{title:"Active Sequences",value:o.ACTIVE,subtitle:"Currently in production",icon:e.jsx(n,{sx:{color:"#4caf50",fontSize:"1.5rem",opacity:.8}})},{title:"Inactive Sequences",value:o.INACTIVE,subtitle:"Not in use",icon:e.jsx(i,{sx:{color:"#f44336",fontSize:"1.5rem",opacity:.8}})}];return e.jsx(s,{sx:{display:"flex",gap:3,mb:4},children:r.map((o,r)=>e.jsx(l,{sx:{flex:1,borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",backgroundColor:"white",transition:"transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 16px rgba(0,0,0,0.15)"}},children:e.jsx(c,{sx:{p:3,position:"relative"},children:e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(s,{children:[e.jsx(t,{variant:"body2",sx:{color:"#666",mb:1,fontSize:"0.875rem",fontWeight:500},children:o.title}),e.jsx(t,{variant:"h4",sx:{fontWeight:600,color:"#333",fontSize:"2rem",mb:.5},children:o.value}),e.jsx(t,{variant:"caption",sx:{color:"#999",fontSize:"0.75rem"},children:o.subtitle})]}),o.icon]})})},r))})},K=({onSearchChange:o,onFilterChange:r,onTypeFilterChange:n})=>{const[i,l]=M.useState("All Sequences"),[c,j]=M.useState("All Types"),[g,b]=M.useState("");return e.jsxs(s,{sx:{backgroundColor:"white",borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsxs(s,{sx:{p:3,borderBottom:"1px solid #e0e0e0"},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(a,{sx:{color:"#666",mr:1,fontSize:"1.25rem"}}),e.jsx(t,{variant:"h5",sx:{fontWeight:600,color:"#333",fontSize:"1.25rem"},children:"Sequence Management"})]}),e.jsx(t,{variant:"body2",sx:{color:"#666",fontSize:"0.875rem"},children:"Manage and configure process sequences for production workflows"})]}),e.jsxs(s,{sx:{p:3,display:"flex",gap:2,alignItems:"center"},children:[e.jsx(d,{placeholder:"Search by Sequence ID or notes",variant:"outlined",size:"small",value:g,onChange:e=>{const s=e.target.value;b(s),o?.(s)},InputProps:{startAdornment:e.jsx(u,{position:"start",children:e.jsx(x,{sx:{color:"#999"}})})},sx:{flex:1,"& .MuiOutlinedInput-root":{borderRadius:"8px",backgroundColor:"#fafafa","& fieldset":{borderColor:"#e0e0e0"},"&:hover fieldset":{borderColor:"#ccc"},"&.Mui-focused fieldset":{borderColor:"#1976d2"}},"& .MuiInputBase-input":{fontSize:"0.875rem",color:"#666","&::placeholder":{color:"#999",opacity:1}}}}),e.jsxs(h,{size:"small",sx:{minWidth:150},children:[e.jsx(p,{children:"Status"}),e.jsx(m,{value:i,label:"Status",onChange:e=>{return s=e.target.value,l(s),void r?.(s);var s},sx:{borderRadius:"8px"},children:["All Sequences","ACTIVE","INACTIVE"].map(s=>e.jsx(f,{value:s,children:s},s))})]}),e.jsxs(h,{size:"small",sx:{minWidth:150},children:[e.jsx(p,{children:"Type"}),e.jsx(m,{value:c,label:"Type",onChange:e=>{return s=e.target.value,j(s),void n?.(s);var s},sx:{borderRadius:"8px"},children:["All Types","Layout","ISP"].map(s=>e.jsx(f,{value:s,children:s},s))})]})]})]})},R=M.memo(({data:o,onActionClick:r,onEdit:a,onView:i})=>{const[l,c]=M.useState(null),[d,u]=M.useState(null),x=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),h=()=>{c(null),u(null)},p=M.useMemo(()=>[{accessorKey:"sequenceId",header:"Sequence ID",size:200,Cell:({row:o})=>e.jsxs(s,{children:[e.jsx(t,{variant:"body2",sx:{fontWeight:500,color:"#333",fontSize:"0.875rem"},children:o.original.sequenceId}),e.jsxs(t,{variant:"caption",sx:{color:"#999",fontSize:"0.75rem",display:"block"},children:["Updated: ",x(o.original.updatedAt)]}),e.jsx(j,{label:o.original.category,size:"small",icon:e.jsx(g,{sx:{fontSize:"0.75rem"}}),sx:{backgroundColor:"#e3f2fd",color:"#1976d2",fontSize:"0.625rem",height:"20px",mt:.5}})]})},{accessorKey:"sequenceName",header:"Sequence Name",size:250,Cell:({row:o})=>e.jsxs(s,{children:[e.jsx(t,{variant:"body2",sx:{fontWeight:500,color:"#333",fontSize:"0.875rem"},children:o.original.sequenceName}),e.jsxs(t,{variant:"caption",sx:{color:"#666",fontSize:"0.75rem"},children:["Type: ",o.original.type]})]})},{accessorKey:"totalSteps",header:"Steps",size:120,Cell:({row:o})=>e.jsxs(s,{children:[e.jsxs(t,{variant:"body2",sx:{color:"#333",fontSize:"0.875rem",fontWeight:500},children:[o.original.totalSteps," Total"]}),e.jsxs(t,{variant:"caption",sx:{color:"#f44336",fontSize:"0.75rem",fontWeight:500},children:[o.original.ctqSteps," CTQ"]})]})},{accessorKey:"notes",header:"Notes",size:250,Cell:({row:s})=>e.jsx(t,{variant:"body2",sx:{color:"#333",fontSize:"0.875rem",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:s.original.notes})},{accessorKey:"createdAt",header:"Created",size:120,Cell:({row:s})=>e.jsx(t,{variant:"body2",sx:{color:"#333",fontSize:"0.875rem"},children:x(s.original.createdAt)})},{accessorKey:"status",header:"Status",size:120,Cell:({row:s})=>{return e.jsx(j,{icon:e.jsx(n,{sx:{fontSize:"0.875rem"}}),label:s.original.status,size:"small",sx:{backgroundColor:(t=s.original.status,"ACTIVE"===t?"#4caf50":"#9e9e9e"),color:"white",fontSize:"0.75rem",height:"24px","& .MuiChip-icon":{color:"white"}}});var t}},{id:"actions",header:"Actions",size:80,enableSorting:!1,Cell:({row:s})=>e.jsx(b,{size:"small",onClick:e=>((e,s)=>{c(e.currentTarget),u(s)})(e,s.original),children:e.jsx(S,{sx:{color:"#666"}})})}],[]);return e.jsxs(s,{sx:{mt:2},children:[e.jsx(L,{data:o,tableColumns:p}),e.jsx(C,{anchorEl:l,open:Boolean(l),onClose:h,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsxs(f,{onClick:()=>{d&&i&&i(d.id),h()},children:[e.jsx(v,{children:e.jsx(y,{fontSize:"small"})}),e.jsx(w,{children:"View"})]},"view"),e.jsxs(f,{onClick:()=>{d&&a&&a(d.id),h()},children:[e.jsx(v,{children:e.jsx(q,{fontSize:"small"})}),e.jsx(w,{children:"Edit"})]},"edit"),e.jsxs(f,{onClick:()=>{d&&r&&r(d.sequenceId,"delete"),h()},sx:{color:"error.main"},children:[e.jsx(v,{children:e.jsx(z,{fontSize:"small",color:"error"})}),e.jsx(w,{children:"Delete"})]},"delete")]})]})}),O=()=>{const r=V(),[a,n]=M.useState(""),[i,l]=M.useState("All Sequences"),[c,d]=M.useState("All Types"),[u,x]=M.useState(!1),[h,p]=M.useState(null),{data:m,isLoading:f,refetch:j}=W(),[g,{isLoading:b}]=D(),S=M.useMemo(()=>m?m.detail:[],[m]),C=M.useMemo(()=>{let e=S;return"All Sequences"!==i&&(e=e.filter(e=>e.status===i)),"All Types"!==c&&(e=e.filter(e=>e.type===c)),a&&(e=e.filter(e=>e.sequenceId.toLowerCase().includes(a.toLowerCase())||e.sequenceName.toLowerCase().includes(a.toLowerCase())||e.category.toLowerCase().includes(a.toLowerCase())||e.type.toLowerCase().includes(a.toLowerCase())||e.notes.toLowerCase().includes(a.toLowerCase()))),e},[S,i,c,a]),v=()=>{x(!1),p(null)};return f?e.jsxs(s,{sx:{p:3,backgroundColor:"#f5f5f5",minHeight:"100vh"},children:[e.jsx(E,{}),e.jsx(N,{})]}):e.jsxs(s,{sx:{p:3,backgroundColor:"#f5f5f5",minHeight:"100vh"},children:[e.jsx(E,{}),m&&e.jsx(F,{headerData:m.header}),e.jsx(K,{onSearchChange:e=>{n(e)},onFilterChange:e=>{l(e)},onTypeFilterChange:e=>{d(e)}}),e.jsx(R,{data:C,onActionClick:(e,s)=>{if("delete"===s){const s=S.find(s=>s.sequenceId===e);s&&(p(s),x(!0))}},onEdit:e=>{r(`/sequence-master/edit-sequence/${e}`)},onView:e=>{r(`/sequence-master/view-sequence/${e}`)}}),e.jsxs(A,{open:u,onClose:v,maxWidth:"sm",fullWidth:!0,children:[e.jsx(I,{children:"Delete Sequence Task"}),e.jsx(T,{children:e.jsxs(t,{children:["Are you sure you want to delete the sequence task for ",e.jsx("strong",{children:h?.sequenceId}),"? This will set the status to INACTIVE and preserve all remaining data."]})}),e.jsxs(k,{children:[e.jsx(o,{onClick:v,disabled:b,children:"Cancel"}),e.jsx(o,{onClick:async()=>{if(h)try{const e=m?.detail.find(e=>e.id===h.id);if(e){const s={id:h.id,data:{processSequence:{status:"INACTIVE",sequenceId:e.sequenceId,sequenceName:e.sequenceName,version:e.version,isLatest:e.isLatest,category:e.category,type:e.type,notes:e.notes,totalSteps:e.totalSteps,ctqSteps:e.ctqSteps},processStepGroups:e.stepGroups.map(e=>({processName:e.processName,processDescription:e.processDescription,sequenceTiming:e.sequenceTiming||0,processSteps:e.steps.map(e=>({parameterDescription:e.parameterDescription,stepNumber:e.stepNumber,stepType:e.stepType,evaluationMethod:e.evaluationMethod,targetValueType:e.targetValueType,minimumAcceptanceValue:e.minimumAcceptanceValue?parseFloat(e.minimumAcceptanceValue):null,maximumAcceptanceValue:e.maximumAcceptanceValue?parseFloat(e.maximumAcceptanceValue):null,multipleMeasurements:e.multipleMeasurements,multipleMeasurementMaxCount:e.multipleMeasurementMaxCount,uom:e.uom,ctq:e.ctq,allowAttachments:e.allowAttachments,responsiblePerson:e.responsiblePerson||!1,notes:e.notes}))}))}};await g(s).unwrap(),await j(),x(!1),p(null)}}catch(e){}},color:"error",variant:"contained",disabled:b,children:b?"Deleting...":"Delete Task"})]})]})]})};export{O as default};

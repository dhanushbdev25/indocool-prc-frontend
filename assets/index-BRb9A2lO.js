import{j as e,I as t,a2 as a,X as o,bn as r,aK as s,bh as i,w as n,bk as l,bl as c,a4 as d,a5 as x,d as h,y as m,Z as u,bo as p,J as f,M as C,Y as j,a8 as b,ah as g,bp as y,aU as v,m as S,bq as w,ad as z,ae as k,af as I,ag as T}from"./mui-vendor-ThRJoe5u.js";import{f as A,r as D}from"./react-vendor-jVbyDP5c.js";import{T as E,C as L}from"./CatalystTableSkeleton-BjboBL1o.js";import{c as M,d as W}from"./index-CgzbgTp3.js";import"./table-vendor-Bx02c7my.js";import"./auth-vendor-BOyMHjHL.js";import"./state-vendor-BxbV2bHq.js";import"./utils-vendor-S0KZLiBE.js";import"./form-vendor-DG-ZRlco.js";import"./ui-vendor-DL_b4SbO.js";const F=()=>{const s=A();return e.jsx(t,{sx:{mb:4},children:e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1},children:[e.jsxs(t,{children:[e.jsx(a,{variant:"h3",sx:{fontWeight:600,color:"#333",mb:1,fontSize:"2rem"},children:"Catalyst Mixing Master"}),e.jsx(a,{variant:"body1",sx:{color:"#666",fontSize:"1rem",fontWeight:400},children:"Manage temperature-based catalyst dosage formulations"})]}),e.jsx(o,{variant:"contained",startIcon:e.jsx(r,{}),onClick:()=>{s("/catalyst-master/create-catalyst")},sx:{backgroundColor:"#1976d2",color:"white",borderRadius:"8px",px:3,py:1.5,textTransform:"none",fontSize:"0.875rem",fontWeight:500,"&:hover":{backgroundColor:"#1565c0"}},children:"Add Chart"})]})})},V=({headerData:o})=>{const r=[{title:"Total Charts",value:o.ACTIVE+o.INACTIVE,subtitle:`${o.ACTIVE} active charts`,icon:e.jsx(s,{sx:{color:"#666",fontSize:"1.5rem",opacity:.7}})},{title:"Active Charts",value:o.ACTIVE,subtitle:"Currently in production",icon:e.jsx(i,{sx:{color:"#4caf50",fontSize:"1.5rem",opacity:.8}})},{title:"Inactive Charts",value:o.INACTIVE,subtitle:"Not in use",icon:e.jsx(n,{sx:{color:"#f44336",fontSize:"1.5rem",opacity:.8}})}];return e.jsx(t,{sx:{display:"flex",gap:3,mb:4},children:r.map((o,r)=>e.jsx(l,{sx:{flex:1,borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",backgroundColor:"white",transition:"transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 16px rgba(0,0,0,0.15)"}},children:e.jsx(c,{sx:{p:3,position:"relative"},children:e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(t,{children:[e.jsx(a,{variant:"body2",sx:{color:"#666",mb:1,fontSize:"0.875rem",fontWeight:500},children:o.title}),e.jsx(a,{variant:"h4",sx:{fontWeight:600,color:"#333",fontSize:"2rem",mb:.5},children:o.value}),e.jsx(a,{variant:"caption",sx:{color:"#999",fontSize:"0.75rem"},children:o.subtitle})]}),o.icon]})})},r))})},R=({onSearchChange:r,onFilterChange:i})=>{const[n,l]=D.useState("All Charts"),[c,u]=D.useState("");return e.jsxs(t,{sx:{backgroundColor:"white",borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsxs(t,{sx:{p:3,borderBottom:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(s,{sx:{color:"#666",mr:1,fontSize:"1.25rem"}}),e.jsx(a,{variant:"h5",sx:{fontWeight:600,color:"#333",fontSize:"1.25rem"},children:"Chart Management"})]}),e.jsx(a,{variant:"body2",sx:{color:"#666",fontSize:"0.875rem"},children:"Manage temperature-based catalyst dosage charts and formulations"})]}),e.jsxs(t,{sx:{p:3,display:"flex",gap:2,alignItems:"center"},children:[e.jsx(d,{placeholder:"Search by Chart ID or notes",variant:"outlined",size:"small",value:c,onChange:e=>{const t=e.target.value;u(t),r?.(t)},InputProps:{startAdornment:e.jsx(x,{position:"start",children:e.jsx(h,{sx:{color:"#999"}})})},sx:{flex:1,"& .MuiOutlinedInput-root":{borderRadius:"8px",backgroundColor:"#fafafa","& fieldset":{borderColor:"#e0e0e0"},"&:hover fieldset":{borderColor:"#ccc"},"&.Mui-focused fieldset":{borderColor:"#1976d2"}},"& .MuiInputBase-input":{fontSize:"0.875rem",color:"#666","&::placeholder":{color:"#999",opacity:1}}}}),e.jsx(m,{direction:"row",spacing:1,children:["All Charts","ACTIVE","INACTIVE"].map(t=>e.jsx(o,{variant:n===t?"contained":"outlined",onClick:()=>(e=>{l(e),i?.(e)})(t),sx:{borderRadius:"8px",textTransform:"none",fontSize:"0.875rem",fontWeight:500,px:2,py:1,minWidth:"auto",...n===t?{backgroundColor:"#1976d2",color:"white","&:hover":{backgroundColor:"#1565c0"}}:{color:"#666",borderColor:"#e0e0e0","&:hover":{borderColor:"#ccc",backgroundColor:"#f5f5f5"}}},children:t},t))})]})]})},N=D.memo(({data:o,onActionClick:r,onEdit:s,onView:n})=>{const[l,c]=D.useState(null),[d,x]=D.useState(null),h=e=>{switch(e){case"ACTIVE":return"#4caf50";case"NEW":return"#2196f3";default:return"#9e9e9e"}},m=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),z=()=>{c(null),x(null)},k=D.useMemo(()=>[{accessorKey:"chartId",header:"Chart ID",size:200,Cell:({row:o})=>e.jsxs(t,{children:[e.jsx(a,{variant:"body2",sx:{fontWeight:500,color:"#333",fontSize:"0.875rem"},children:o.original.chartId}),e.jsxs(a,{variant:"caption",sx:{color:"#999",fontSize:"0.75rem",display:"block"},children:["Updated: ",m(o.original.updatedAt)]}),e.jsx(u,{label:o.original.chartSupplier,size:"small",icon:e.jsx(p,{sx:{fontSize:"0.75rem"}}),sx:{backgroundColor:"#e3f2fd",color:"#1976d2",fontSize:"0.625rem",height:"20px",mt:.5}})]})},{accessorKey:"mekpDensity",header:"MEKP Density",size:120,Cell:({row:t})=>e.jsxs(a,{variant:"body2",sx:{color:"#333",fontSize:"0.875rem",fontWeight:500},children:[t.original.mekpDensity," g/cmÂ³"]})},{accessorKey:"notes",header:"Notes",size:250,Cell:({row:t})=>e.jsx(a,{variant:"body2",sx:{color:"#333",fontSize:"0.875rem",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:t.original.notes})},{accessorKey:"createdAt",header:"Created",size:120,Cell:({row:t})=>e.jsx(a,{variant:"body2",sx:{color:"#333",fontSize:"0.875rem"},children:m(t.original.createdAt)})},{accessorKey:"status",header:"Status",size:120,Cell:({row:t})=>e.jsx(u,{icon:e.jsx(i,{sx:{fontSize:"0.875rem"}}),label:t.original.status,size:"small",sx:{backgroundColor:h(t.original.status),color:"white",fontSize:"0.75rem",height:"24px","& .MuiChip-icon":{color:"white"}}})},{id:"actions",header:"Actions",size:80,enableSorting:!1,Cell:({row:t})=>e.jsx(f,{size:"small",onClick:e=>((e,t)=>{c(e.currentTarget),x(t)})(e,t.original),children:e.jsx(C,{sx:{color:"#666"}})})}],[]);return e.jsxs(t,{sx:{mt:2},children:[e.jsx(E,{data:o,tableColumns:k}),e.jsx(j,{anchorEl:l,open:Boolean(l),onClose:z,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsxs(b,{onClick:()=>{d&&n&&n(d.id),z()},children:[e.jsx(g,{children:e.jsx(y,{fontSize:"small"})}),e.jsx(v,{children:"View"})]},"view"),e.jsxs(b,{onClick:()=>{d&&s&&s(d.id),z()},children:[e.jsx(g,{children:e.jsx(S,{fontSize:"small"})}),e.jsx(v,{children:"Edit"})]},"edit"),e.jsxs(b,{onClick:()=>{d&&r&&r(d.chartId,"delete"),z()},sx:{color:"error.main"},children:[e.jsx(g,{children:e.jsx(w,{fontSize:"small",color:"error"})}),e.jsx(v,{children:"Delete"})]},"delete")]})]})}),K=()=>{const r=A(),[s,i]=D.useState(""),[n,l]=D.useState("All Charts"),[c,d]=D.useState(!1),[x,h]=D.useState(null),{data:m,isLoading:u,refetch:p}=M(),[f,{isLoading:C}]=W(),j=D.useMemo(()=>m?m.detail.map(e=>e.catalyst):[],[m]),b=D.useMemo(()=>{let e=j;return"All Charts"!==n&&(e=e.filter(e=>e.status===n)),s&&(e=e.filter(e=>e.chartId.toLowerCase().includes(s.toLowerCase())||e.chartSupplier.toLowerCase().includes(s.toLowerCase())||e.notes.toLowerCase().includes(s.toLowerCase()))),e},[j,n,s]),g=()=>{d(!1),h(null)};return u?e.jsxs(t,{sx:{p:3,backgroundColor:"#f5f5f5",minHeight:"100vh"},children:[e.jsx(F,{}),e.jsx(L,{})]}):e.jsxs(t,{sx:{p:3,backgroundColor:"#f5f5f5",minHeight:"100vh"},children:[e.jsx(F,{}),m&&e.jsx(V,{headerData:m.header}),e.jsx(R,{onSearchChange:e=>{i(e)},onFilterChange:e=>{l(e)}}),e.jsx(N,{data:b,onActionClick:(e,t)=>{if("delete"===t){const t=j.find(t=>t.chartId===e);t&&(h(t),d(!0))}},onEdit:e=>{r(`/catalyst-master/edit-catalyst/${e}`)},onView:e=>{r(`/catalyst-master/view-catalyst/${e}`)}}),e.jsxs(z,{open:c,onClose:g,maxWidth:"sm",fullWidth:!0,children:[e.jsx(k,{children:"Delete Catalyst Task"}),e.jsx(I,{children:e.jsxs(a,{children:["Are you sure you want to delete the catalyst task for ",e.jsx("strong",{children:x?.chartId}),"? This will set the status to INACTIVE and preserve all remaining data."]})}),e.jsxs(T,{children:[e.jsx(o,{onClick:g,disabled:C,children:"Cancel"}),e.jsx(o,{onClick:async()=>{if(x)try{const e=m?.detail.find(e=>e.catalyst.id===x.id);if(e){const t={catalyst:{id:x.id,version:e.catalyst.version,status:"INACTIVE",chartId:e.catalyst.chartId,chartSupplier:e.catalyst.chartSupplier,notes:e.catalyst.notes,mekpDensity:parseFloat(e.catalyst.mekpDensity),isActive:e.catalyst.isActive},catalystConfiguration:e.catalystConfiguration.map(e=>({minTemperature:parseFloat(e.minTemperature),maxTemperature:parseFloat(e.maxTemperature),minHumidity:parseFloat(e.minHumidity),maxHumidity:parseFloat(e.maxHumidity),minGelcoat:parseFloat(e.minGelcoat),maxGelcoat:parseFloat(e.maxGelcoat),gelcoatLabel:e.gelcoatLabel,minResinDosage:parseFloat(e.minResinDosage),maxResinDosage:parseFloat(e.maxResinDosage),resinLabel:e.resinLabel,minTopCoat:e.minTopCoat?parseFloat(e.minTopCoat):0,maxTopCoat:e.maxTopCoat?parseFloat(e.maxTopCoat):0,topCoatLabel:e.topCoatLabel||"",blockCatalystMixing:e.blockCatalystMixing,requestSupervisorApproval:e.requestSupervisorApproval}))};await f(t).unwrap(),await p(),d(!1),h(null)}}catch(e){}},color:"error",variant:"contained",disabled:C,children:C?"Deleting...":"Delete Task"})]})]})]})};export{K as default};

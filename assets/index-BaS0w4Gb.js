import{j as e,I as t,a2 as r,X as a,bn as s,aO as i,bh as o,bK as n,w as l,bk as c,bl as d,a4 as x,a5 as p,d as u,y as m,Z as h,J as f,M as g,Y as b,a8 as j,ah as C,bp as v,aU as w,m as y,bq as S,ad as M,ae as z,af as N,ag as A}from"./mui-vendor-ThRJoe5u.js";import{f as k,r as I}from"./react-vendor-jVbyDP5c.js";import{T,C as L}from"./CatalystTableSkeleton-BjboBL1o.js";import{y as P,z as E}from"./index-De03Ly_y.js";import"./table-vendor-Bx02c7my.js";import"./auth-vendor-BOyMHjHL.js";import"./state-vendor-BxbV2bHq.js";import"./utils-vendor-S0KZLiBE.js";import"./form-vendor-DG-ZRlco.js";import"./ui-vendor-DL_b4SbO.js";const D=()=>{const i=k();return e.jsx(t,{sx:{mb:4},children:e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1},children:[e.jsxs(t,{children:[e.jsx(r,{variant:"h3",sx:{fontWeight:600,color:"#333",mb:1,fontSize:"2rem"},children:"Part Master"}),e.jsx(r,{variant:"body1",sx:{color:"#666",fontSize:"1rem",fontWeight:400},children:"Manage parts, raw materials, and technical specifications"})]}),e.jsx(a,{variant:"contained",startIcon:e.jsx(s,{}),onClick:()=>{i("/part-master/create-part")},sx:{backgroundColor:"#1976d2",color:"white",borderRadius:"8px",px:3,py:1.5,textTransform:"none",fontSize:"0.875rem",fontWeight:500,"&:hover":{backgroundColor:"#1565c0"}},children:"Create Part"})]})})},W=({headerData:a})=>{const s=[{title:"Total Parts",value:a.ACTIVE+a.NEW+a.INACTIVE,subtitle:`${a.ACTIVE} active parts`,icon:e.jsx(i,{sx:{color:"#666",fontSize:"1.5rem",opacity:.7}})},{title:"Active Parts",value:a.ACTIVE,subtitle:"Currently in use",icon:e.jsx(o,{sx:{color:"#4caf50",fontSize:"1.5rem",opacity:.8}})},{title:"New Parts",value:a.NEW,subtitle:"Recently created",icon:e.jsx(n,{sx:{color:"#2196f3",fontSize:"1.5rem",opacity:.8}})},{title:"Inactive Parts",value:a.INACTIVE,subtitle:"Not in use",icon:e.jsx(l,{sx:{color:"#9e9e9e",fontSize:"1.5rem",opacity:.8}})}];return e.jsx(t,{sx:{display:"flex",gap:3,mb:4},children:s.map((a,s)=>e.jsx(c,{sx:{flex:1,borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",backgroundColor:"white",transition:"transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 16px rgba(0,0,0,0.15)"}},children:e.jsx(d,{sx:{p:3,position:"relative"},children:e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(t,{children:[e.jsx(r,{variant:"body2",sx:{color:"#666",mb:1,fontSize:"0.875rem",fontWeight:500},children:a.title}),e.jsx(r,{variant:"h4",sx:{fontWeight:600,color:"#333",fontSize:"2rem",mb:.5},children:a.value}),e.jsx(r,{variant:"caption",sx:{color:"#999",fontSize:"0.75rem"},children:a.subtitle})]}),e.jsx(t,{sx:{opacity:.7,transition:"opacity 0.2s ease-in-out","&:hover":{opacity:1}},children:a.icon})]})})},s))})},R=({onSearchChange:s,onFilterChange:o})=>{const[n,l]=I.useState("All Parts"),[c,d]=I.useState("");return e.jsxs(t,{sx:{backgroundColor:"white",borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",mb:3},children:[e.jsxs(t,{sx:{p:3,borderBottom:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(i,{sx:{color:"#666",mr:1,fontSize:"1.25rem"}}),e.jsx(r,{variant:"h5",sx:{fontWeight:600,color:"#333",fontSize:"1.25rem"},children:"Part Management"})]}),e.jsx(r,{variant:"body2",sx:{color:"#666",fontSize:"0.875rem"},children:"Search and filter parts by status, part number, drawing number, or customer"})]}),e.jsxs(t,{sx:{p:3,display:"flex",gap:2,alignItems:"center"},children:[e.jsx(x,{placeholder:"Search by Part Number, Drawing Number, Description, or Customer",variant:"outlined",size:"small",value:c,onChange:e=>{const t=e.target.value;d(t),s?.(t)},InputProps:{startAdornment:e.jsx(p,{position:"start",children:e.jsx(u,{sx:{color:"#999"}})})},sx:{flex:1,"& .MuiOutlinedInput-root":{borderRadius:"8px",backgroundColor:"#fafafa","& fieldset":{borderColor:"#e0e0e0"},"&:hover fieldset":{borderColor:"#ccc"},"&.Mui-focused fieldset":{borderColor:"#1976d2"}},"& .MuiInputBase-input":{fontSize:"0.875rem",color:"#666","&::placeholder":{color:"#999",opacity:1}}}}),e.jsx(m,{direction:"row",spacing:1,children:["All Parts","ACTIVE","NEW","INACTIVE"].map(t=>e.jsx(a,{variant:n===t?"contained":"outlined",onClick:()=>(e=>{l(e),o?.(e)})(t),sx:{borderRadius:"8px",textTransform:"none",fontSize:"0.875rem",fontWeight:500,px:2,py:1,minWidth:"auto",...n===t?{backgroundColor:"#1976d2",color:"white","&:hover":{backgroundColor:"#1565c0"}}:{color:"#666",borderColor:"#e0e0e0","&:hover":{borderColor:"#ccc",backgroundColor:"#f5f5f5"}}},children:t},t))})]})]})},V=I.memo(({data:a,onActionClick:s,onEdit:n,onView:l})=>{const c=a||[],[d,x]=I.useState(null),[p,u]=I.useState(null),m=I.useCallback((e,t)=>{x(e.currentTarget),u(t)},[]),M=()=>{x(null),u(null)},z=e=>{switch(e){case"ACTIVE":return"#4caf50";case"NEW":return"#2196f3";default:return"#9e9e9e"}},N=I.useMemo(()=>[{accessorKey:"partNumber",header:"Part Number",size:200,Cell:({row:a})=>{return e.jsxs(t,{children:[e.jsx(r,{variant:"body2",sx:{fontWeight:500,color:"#333",fontSize:"0.875rem"},children:a.original.partNumber}),e.jsx(r,{variant:"caption",sx:{color:"#999",fontSize:"0.75rem",display:"block"},children:a.original.updatedAt?`Updated: ${s=a.original.updatedAt,new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}`:""}),e.jsx(h,{label:`v${a.original.version}`,size:"small",icon:e.jsx(i,{sx:{fontSize:"0.75rem"}}),sx:{backgroundColor:"#e3f2fd",color:"#1976d2",fontSize:"0.625rem",height:"20px",mt:.5}})]});var s}},{accessorKey:"drawingNumber",header:"Drawing Number",size:150,Cell:({row:t})=>e.jsx(r,{variant:"body2",sx:{color:"#333",fontSize:"0.875rem",fontWeight:500},children:t.original.drawingNumber})},{accessorKey:"status",header:"Status",size:120,Cell:({row:t})=>e.jsx(h,{label:t.original.status,icon:e.jsx(o,{sx:{fontSize:"0.75rem"}}),sx:{backgroundColor:z(t.original.status),color:"white",fontSize:"0.75rem",height:"24px","& .MuiChip-icon":{color:"white"}}})},{accessorKey:"customerName",header:"Customer",size:200,Cell:({row:t})=>e.jsx(r,{variant:"body2",sx:{color:"#666",fontSize:"0.875rem"},children:t.original.customerName||t.original.customer})},{accessorKey:"description",header:"Description",size:250,Cell:({row:t})=>e.jsx(r,{variant:"body2",sx:{color:"#666",fontSize:"0.875rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.original.description})},{accessorKey:"components",header:"Components",size:150,Cell:({row:a})=>e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[e.jsxs(r,{variant:"caption",sx:{fontSize:"0.75rem",color:"#666"},children:["RM: ",a.original.totalRawMaterials]}),e.jsxs(r,{variant:"caption",sx:{fontSize:"0.75rem",color:"#666"},children:["Drill: ",a.original.totalDrilling," | Cut: ",a.original.totalCutting]})]})},{accessorKey:"actions",header:"Actions",size:80,Cell:({row:t})=>e.jsx(f,{size:"small",onClick:e=>m(e,t.original),sx:{color:"#666"},children:e.jsx(g,{fontSize:"small"})})}],[m]);return 0===c.length?e.jsxs(t,{sx:{textAlign:"center",py:8},children:[e.jsx(i,{sx:{fontSize:64,color:"#ccc",mb:2}}),e.jsx(r,{variant:"h6",sx:{color:"#666",mb:1},children:"No Parts Found"}),e.jsx(r,{variant:"body2",color:"textSecondary",sx:{mt:1},children:"Create your first part to get started"})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{tableColumns:N,data:c}),e.jsxs(b,{anchorEl:d,open:Boolean(d),onClose:M,children:[e.jsxs(j,{onClick:()=>{p&&l&&l(p.id),M()},children:[e.jsx(C,{children:e.jsx(v,{fontSize:"small"})}),e.jsx(w,{children:"View"})]}),e.jsxs(j,{onClick:()=>{p&&n&&n(p.id),M()},children:[e.jsx(C,{children:e.jsx(y,{fontSize:"small"})}),e.jsx(w,{children:"Edit"})]}),e.jsxs(j,{onClick:()=>{p&&s&&s(p.partNumber,"delete"),M()},sx:{color:"#f44336"},children:[e.jsx(C,{children:e.jsx(S,{fontSize:"small",sx:{color:"#f44336"}})}),e.jsx(w,{children:"Delete"})]})]})]})});V.displayName="PartTable";const K=()=>{const s=k(),[i,o]=I.useState(""),[n,l]=I.useState("All Parts"),[c,d]=I.useState(!1),[x,p]=I.useState(null),{data:u,isLoading:m,refetch:h}=P(),[f,{isLoading:g}]=E(),b=I.useMemo(()=>u?u.detail.filter(e=>void 0!==e.partMaster.id).map(e=>({id:e.partMaster.id,partNumber:e.partMaster.partNumber,drawingNumber:e.partMaster.drawingNumber,status:e.partMaster.status,customer:e.partMaster.customer,customerName:e.partMaster.customerName||"",description:e.partMaster.description,version:e.partMaster.version,totalRawMaterials:e.rawMaterials.length,totalDrilling:e.drilling.length,totalCutting:e.cutting.length,createdAt:e.partMaster.createdAt||"",updatedAt:e.partMaster.updatedAt||""})):[],[u]),j=I.useMemo(()=>{let e=b;return"All Parts"!==n&&(e=e.filter(e=>e.status===n)),i&&(e=e.filter(e=>e.partNumber.toLowerCase().includes(i.toLowerCase())||e.drawingNumber.toLowerCase().includes(i.toLowerCase())||e.description.toLowerCase().includes(i.toLowerCase())||e.customerName.toLowerCase().includes(i.toLowerCase()))),e},[b,n,i]),C=()=>{d(!1),p(null)};return m?e.jsxs(t,{sx:{p:3,minHeight:"100vh"},children:[e.jsx(D,{}),e.jsx(L,{})]}):e.jsxs(t,{sx:{p:3,minHeight:"100vh"},children:[e.jsx(D,{}),u&&e.jsx(W,{headerData:u.header}),e.jsx(R,{onSearchChange:e=>{o(e)},onFilterChange:e=>{l(e)}}),e.jsx(t,{sx:{backgroundColor:"white",borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",overflow:"hidden"},children:e.jsx(V,{data:j,onActionClick:(e,t)=>{if("delete"===t){const t=b.find(t=>t.partNumber===e);t&&(p(t),d(!0))}},onEdit:e=>{s(`/part-master/edit-part/${e}`)},onView:e=>{s(`/part-master/view-part/${e}`)}})}),e.jsxs(M,{open:c,onClose:C,maxWidth:"sm",fullWidth:!0,children:[e.jsx(z,{children:"Delete Part"}),e.jsx(N,{children:e.jsxs(r,{children:["Are you sure you want to delete the part ",e.jsx("strong",{children:x?.partNumber}),"? This will set the status to INACTIVE and preserve all remaining data."]})}),e.jsxs(A,{children:[e.jsx(a,{onClick:C,disabled:g,children:"Cancel"}),e.jsx(a,{onClick:async()=>{if(x)try{const e=u?.detail.find(e=>e.partMaster.id===x.id);if(e){const t={partMaster:{id:e.partMaster.id,partNumber:e.partMaster.partNumber,drawingNumber:e.partMaster.drawingNumber,drawingRevision:e.partMaster.drawingRevision,partRevision:e.partMaster.partRevision,status:e.partMaster.status,customer:e.partMaster.customer,description:e.partMaster.description,notes:e.partMaster.notes||"",layupType:e.partMaster.layupType||"",model:e.partMaster.model||"",version:e.partMaster.version,isLatest:e.partMaster.isLatest,catalyst:e.partMaster.catalyst,prcTemplate:e.partMaster.prcTemplate},rawMaterials:e.rawMaterials.map(e=>({materialName:e.materialName,materialCode:e.materialCode,quantity:e.quantity,uom:e.uom,version:e.version,isLatest:e.isLatest,batching:e.batching||!1,splitting:e.splitting||!1,splittingConfiguration:e.splittingConfiguration||null})),drilling:e.drilling.map(e=>({characteristics:e.characteristics,specification:e.specification,noOfHoles:e.noOfHoles,diaOfHoles:e.diaOfHoles,tolerance:e.tolerance,version:e.version,isLatest:e.isLatest})),cutting:e.cutting.map(e=>({characteristics:e.characteristics,specification:e.specification,tolerance:e.tolerance,version:e.version,isLatest:e.isLatest}))};await f(t).unwrap(),await h(),d(!1),p(null)}}catch(e){}},color:"error",variant:"contained",disabled:g,children:g?"Deleting...":"Delete Part"})]})]})]})};export{K as default};

import{j as e,I as s,br as r,a2 as n,z as a,bg as i,a4 as t,an as o,ao as l,aP as c,X as d,bn as x,aN as m,bk as p,J as h,aV as u,E as j,bq as f,_ as b,al as g,bl as v,b3 as y,a6 as C,a7 as I,a8 as P,O as k,bc as S,ay as w,bL as z,bM as N,N as R,bh as T,Z as W,w as A,bN as M,bC as $,bD as V,bF as q,U as O,ac as D,ai as E,am as L,ap as B,aj as F,aq as H,$ as Q,bs as U,bt as Y,bu as K,e as G}from"./mui-vendor-ThRJoe5u.js";import{r as J,f as X,j as Z}from"./react-vendor-jVbyDP5c.js";import{C as _,l as ee,m as se,f as re,F as ne}from"./form-vendor-DG-ZRlco.js";import{o as ae}from"./yup-lT2MYDzp.js";import{S as ie}from"./utils-vendor-S0KZLiBE.js";import{A as te,o as oe,p as le,q as ce,r as de}from"./index-De03Ly_y.js";import{d as xe,p as me,r as pe,a as he,c as ue,b as je,i as fe}from"./schemas-32M61VcH.js";import"./auth-vendor-BOyMHjHL.js";import"./state-vendor-BxbV2bHq.js";import"./ui-vendor-DL_b4SbO.js";const be=({control:c,errors:d})=>e.jsxs(s,{children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(r,{sx:{mr:1,color:"#1976d2"}}),e.jsx(n,{variant:"h6",sx:{fontWeight:600,color:"#333"},children:"Basic Information"})]}),e.jsx(a,{sx:{p:3,borderRadius:2,border:"1px solid #e0e0e0"},children:e.jsxs(i,{container:!0,spacing:3,children:[e.jsx(i,{size:{xs:12,md:6},children:e.jsx(_,{name:"inspectionName",control:c,render:({field:s})=>e.jsx(t,{...s,fullWidth:!0,label:"Inspection Name",required:!0,placeholder:"Enter inspection name",helperText:d.inspectionName?.message||"Name of the inspection procedure",error:!!d.inspectionName,sx:{"& .MuiOutlinedInput-root":{borderRadius:"8px"}}})})}),e.jsx(i,{size:{xs:12,md:6},children:e.jsx(_,{name:"inspectionId",control:c,render:({field:s})=>e.jsx(t,{...s,fullWidth:!0,label:"Inspection ID",required:!0,placeholder:"e.g., INSP-001",helperText:d.inspectionId?.message||"Unique identifier for the inspection",error:!!d.inspectionId,onChange:e=>s.onChange(e.target.value.toUpperCase()),sx:{"& .MuiOutlinedInput-root":{borderRadius:"8px"}}})})}),e.jsx(i,{size:{xs:12,md:6},children:e.jsx(_,{name:"type",control:c,render:({field:s})=>e.jsx(t,{...s,fullWidth:!0,label:"Type",placeholder:"e.g., RESIN, GELCOAT, LAMINATE",helperText:d.type?.message||"Type of inspection procedure",error:!!d.type,sx:{"& .MuiOutlinedInput-root":{borderRadius:"8px"}}})})}),e.jsx(i,{size:{xs:12,md:6},children:e.jsx(_,{name:"status",control:c,render:({field:s})=>e.jsx(o,{control:e.jsx(l,{checked:s.value,onChange:s.onChange,color:"primary"}),label:"Active Status",sx:{mt:2}})})}),e.jsx(i,{size:{xs:12},children:e.jsx(_,{name:"notes",control:c,render:({field:s})=>e.jsx(t,{...s,label:"Notes",fullWidth:!0,multiline:!0,rows:3,error:!!d.notes,helperText:d.notes?String(d.notes):"Additional notes or comments about the inspection",placeholder:"Enter any additional notes or comments",sx:{"& .MuiOutlinedInput-root":{borderRadius:"8px"}}})})})]})})]}),ge=({control:r,errors:l})=>{const[S,w]=J.useState(new Set([0])),[z,N]=J.useState(new Set),{fields:R,append:T,remove:W}=ee({control:r,name:"inspectionParameters"}),A=se({control:r,name:"inspectionParameters"}),M=J.useMemo(()=>A,[A]);J.useEffect(()=>{const e=new Set(S);let s=!1;R.length>0&&!z.has(0)&&!e.has(0)&&(e.add(0),s=!0),l.inspectionParameters&&Array.isArray(l.inspectionParameters)&&l.inspectionParameters.forEach((r,n)=>{r&&Object.keys(r).length>0&&!z.has(n)&&(e.has(n)||(e.add(n),s=!0))}),s&&setTimeout(()=>w(e),0)},[l.inspectionParameters,S,z,R.length]);const $=J.useCallback(()=>{T({...xe,order:R.length+1})},[T,R.length]),V=J.useCallback(e=>{w(s=>{const r=new Set(s);return r.has(e)?(r.delete(e),N(s=>new Set(s).add(e))):(r.add(e),N(s=>{const r=new Set(s);return r.delete(e),r})),r})},[]);return e.jsxs(s,{children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(c,{sx:{mr:1,color:"#1976d2"}}),e.jsx(n,{variant:"h6",sx:{fontWeight:600,color:"#333"},children:"Inspection Parameters"})]}),e.jsxs(a,{sx:{p:3,borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(s,{children:[e.jsx(n,{variant:"subtitle1",sx:{fontWeight:600,color:"#333",mb:.5},children:"Parameter Configuration"}),e.jsx(n,{variant:"body2",sx:{color:"#666"},children:"Define inspection parameters with specifications, tolerances, and responsible roles"})]}),e.jsx(d,{variant:"contained",startIcon:e.jsx(x,{}),onClick:$,sx:{textTransform:"none",borderRadius:"8px",backgroundColor:"#1976d2","&:hover":{backgroundColor:"#1565c0"}},children:"Add Parameter"})]}),R.map((a,c)=>((a,c)=>{const d=S.has(c),x=l.inspectionParameters?.[c]||{},w=d;return e.jsxs(p,{sx:{mb:3,border:"1px solid #e0e0e0",borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",backgroundColor:"white",overflow:"hidden"},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:3,backgroundColor:"#f8f9fa",borderBottom:"1px solid #e0e0e0"},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",flex:1},children:[e.jsx(m,{sx:{color:"#1976d2",mr:2,fontSize:"1.5rem"}}),e.jsxs(s,{sx:{flex:1},children:[e.jsxs(n,{variant:"h6",sx:{fontWeight:600,color:"#333",mb:.5},children:["Parameter ",c+1]}),e.jsx(_,{name:`inspectionParameters.${c}.parameterName`,control:r,render:({field:s})=>e.jsx(n,{variant:"body2",sx:{color:s.value?"#333":"#999",fontStyle:s.value?"normal":"italic",fontSize:"0.875rem"},children:s.value})})]})]}),e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(h,{onClick:()=>V(c),sx:{color:"#666","&:hover":{backgroundColor:"rgba(0,0,0,0.04)"}},children:d?e.jsx(u,{}):e.jsx(j,{})}),e.jsx(h,{color:"error",onClick:()=>W(c),sx:{backgroundColor:"#ffebee","&:hover":{backgroundColor:"#ffcdd2"}},children:e.jsx(f,{})})]})]}),e.jsxs(b,{in:w,children:[e.jsx(g,{sx:{my:2}}),e.jsx(v,{sx:{p:3},children:e.jsxs(i,{container:!0,spacing:3,children:[e.jsx(i,{size:{xs:12,md:6},children:e.jsx(_,{name:`inspectionParameters.${c}.parameterName`,control:r,render:({field:s})=>e.jsx(t,{...s,label:"Parameter Name",fullWidth:!0,required:!0,error:!!x?.parameterName,helperText:x?.parameterName?.message||"Name of the inspection parameter",placeholder:"e.g., Mixing Ratio",sx:{"& .MuiOutlinedInput-root":{borderRadius:"8px"}}})})}),e.jsx(i,{size:{xs:12,md:6},children:e.jsx(_,{name:`inspectionParameters.${c}.type`,control:r,render:({field:s})=>e.jsxs(y,{fullWidth:!0,error:!!x?.type,children:[e.jsx(C,{children:"Parameter Type"}),e.jsx(I,{...s,label:"Parameter Type",children:me.map(s=>e.jsx(P,{value:s.value,children:s.label},s.value))}),x?.type?.message&&e.jsx(n,{variant:"caption",color:"error",sx:{mt:.5,ml:1.5},children:x?.type?.message})]})})}),e.jsx(i,{size:{xs:12},children:e.jsx(_,{name:`inspectionParameters.${c}.specification`,control:r,render:({field:s})=>e.jsx(t,{...s,label:"Specification",fullWidth:!0,multiline:!0,rows:3,error:!!x?.specification,helperText:x?.specification?.message||"Detailed specification for this parameter (optional)",placeholder:"e.g., Resin:Catalyst = 100:1.5 Â± 0.2",sx:{"& .MuiOutlinedInput-root":{borderRadius:"8px"}}})})}),"number"!==(M?.[c]?.type||"text")?null:e.jsx(i,{size:{xs:12,md:6},children:e.jsx(_,{name:`inspectionParameters.${c}.tolerance`,control:r,render:({field:s})=>e.jsx(t,{...s,label:"Tolerance",fullWidth:!0,type:"number",error:!!x?.tolerance,helperText:x?.tolerance?.message||"Acceptable deviation from specification (numeric value)",placeholder:"0.2",sx:{"& .MuiOutlinedInput-root":{borderRadius:"8px"}}})})}),e.jsx(i,{size:{xs:12,md:6},children:e.jsx(_,{name:`inspectionParameters.${c}.role`,control:r,render:({field:s})=>e.jsxs(y,{fullWidth:!0,error:!!x?.role,children:[e.jsx(C,{children:"Responsible Role"}),e.jsx(I,{...s,label:"Responsible Role",children:pe.map(s=>e.jsx(P,{value:s.value,children:s.label},s.value))}),x?.role?.message&&e.jsx(n,{variant:"caption",color:"error",sx:{mt:.5,ml:1.5},children:x?.role?.message})]})})}),e.jsx(i,{size:{xs:12},children:e.jsx(_,{name:`inspectionParameters.${c}.ctq`,control:r,render:({field:r})=>e.jsx(o,{control:e.jsx(k,{checked:r.value,onChange:r.onChange,color:"primary"}),label:e.jsxs(s,{children:[e.jsx(n,{variant:"body1",sx:{fontWeight:500},children:"Critical to Quality (CTQ)"}),e.jsx(n,{variant:"caption",sx:{color:"#666"},children:"Mark this parameter as critical for quality control"})]})})})}),"table"!==(M?.[c]?.type||"text")?null:e.jsxs(i,{size:{xs:12},children:[e.jsx(g,{sx:{my:2}}),e.jsx(ve,{parameterIndex:c,control:r,errors:l})]})]})})]})]},String(a.id))})(a,c)),0===R.length&&e.jsxs(s,{sx:{textAlign:"center",py:6,border:"2px dashed #e0e0e0",borderRadius:2},children:[e.jsx(m,{sx:{fontSize:48,color:"#ccc",mb:2}}),e.jsx(n,{variant:"h6",sx:{color:"#666",mb:1},children:"No Parameters Added"}),e.jsx(n,{variant:"body2",sx:{color:"#999",mb:3},children:"Add inspection parameters to define what needs to be checked during the inspection process"}),e.jsx(d,{variant:"outlined",startIcon:e.jsx(x,{}),onClick:$,sx:{textTransform:"none",borderRadius:"8px",borderColor:"#1976d2",color:"#1976d2","&:hover":{borderColor:"#1565c0",backgroundColor:"#f3f8ff"}},children:"Add First Parameter"})]})]})]})},ve=J.memo(({parameterIndex:r,control:a,errors:l})=>{const{fields:c,append:m,remove:u}=ee({control:a,name:`inspectionParameters.${r}.columns`}),j=se({control:a,name:`inspectionParameters.${r}.columns`}),b=J.useMemo(()=>j,[j]),g=J.useCallback(()=>{m(he)},[m]),k=J.useCallback(e=>{u(e)},[u]);return e.jsxs(s,{children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(s,{children:[e.jsx(n,{variant:"subtitle2",sx:{fontWeight:600,color:"#555",mb:.5},children:"Parameter Columns"}),e.jsx(n,{variant:"caption",sx:{color:"#666"},children:"Define specific columns for this parameter (e.g., Resin, Catalyst, etc.)"})]}),e.jsx(d,{variant:"outlined",startIcon:e.jsx(x,{}),onClick:g,size:"small",sx:{textTransform:"none",borderRadius:"8px",borderColor:"#1976d2",color:"#1976d2","&:hover":{borderColor:"#1565c0",backgroundColor:"#f3f8ff"}},children:"Add Column"})]}),c.map((n,c)=>e.jsx(p,{sx:{mb:2,border:"1px solid #e0e0e0",borderRadius:"8px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",backgroundColor:"#fafafa"},children:e.jsx(v,{sx:{p:2},children:e.jsxs(i,{container:!0,spacing:2,sx:{alignItems:"flex-start"},children:[e.jsx(i,{size:{xs:12,sm:3},children:e.jsx(_,{name:`inspectionParameters.${r}.columns.${c}.name`,control:a,render:({field:s})=>e.jsx(t,{...s,label:"Column Name",fullWidth:!0,size:"small",required:!0,error:!!l.inspectionParameters?.[r]?.columns?.[c]?.name,helperText:l.inspectionParameters?.[r]?.columns?.[c]?.name?.message||"Name of the column",placeholder:"e.g., Resin",sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"white"}}})})}),e.jsx(i,{size:{xs:12,sm:3},children:e.jsx(_,{name:`inspectionParameters.${r}.columns.${c}.type`,control:a,render:({field:s})=>e.jsxs(y,{fullWidth:!0,size:"small",required:!0,error:!!l.inspectionParameters?.[r]?.columns?.[c]?.type,children:[e.jsx(C,{children:"Data Type"}),e.jsx(I,{...s,label:"Data Type",children:ue.map(s=>e.jsx(P,{value:s.value,children:s.label},s.value))})]})})}),e.jsx(i,{size:{xs:12,sm:2},children:(()=>{const s=b?.[c]?.type||"text";return"datetime"===s?e.jsx(_,{name:`inspectionParameters.${r}.columns.${c}.defaultValue`,control:a,render:({field:s})=>e.jsx(S,{dateAdapter:te,children:e.jsx(w,{label:"Default Value",value:s.value?oe(s.value):null,onChange:e=>{const r=e?e.format("YYYY-MM-DDTHH:mm"):"";s.onChange(r)},slotProps:{textField:{fullWidth:!0,size:"small",helperText:"Default datetime value",sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"white"}}}}})})}):"ok/not ok"===s?e.jsx(_,{name:`inspectionParameters.${r}.columns.${c}.defaultValue`,control:a,render:({field:s})=>e.jsxs(y,{component:"fieldset",fullWidth:!0,children:[e.jsx(z,{component:"legend",sx:{fontSize:"0.75rem",color:"#666",mb:.5},children:"Default Value"}),e.jsxs(N,{row:!0,value:s.value||"",onChange:e=>s.onChange(e.target.value),sx:{gap:1},children:[e.jsx(o,{value:"ok",control:e.jsx(R,{size:"small",color:"success"}),label:"OK",sx:{"& .MuiFormControlLabel-label":{fontSize:"0.75rem",color:"ok"===s.value?"#2e7d32":"#666"}}}),e.jsx(o,{value:"not ok",control:e.jsx(R,{size:"small",color:"error"}),label:"Not OK",sx:{"& .MuiFormControlLabel-label":{fontSize:"0.75rem",color:"not ok"===s.value?"#d32f2f":"#666"}}})]})]})}):e.jsx(_,{name:`inspectionParameters.${r}.columns.${c}.defaultValue`,control:a,render:({field:r})=>e.jsx(t,{...r,label:"Default Value",fullWidth:!0,size:"small",type:"number"===s?"number":"text",placeholder:"number"===s?"100":"boolean"===s?"true/false":"default value",helperText:"number"===s?"Numeric default value":"boolean"===s?"Boolean default value (true/false)":"Default value",sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"white"}}})})})()}),e.jsx(i,{size:{xs:12,sm:2},children:"number"!==(b?.[c]?.type||"text")?null:e.jsx(_,{name:`inspectionParameters.${r}.columns.${c}.tolerance`,control:a,render:({field:s})=>e.jsx(t,{...s,label:"Tolerance",fullWidth:!0,size:"small",type:"number",placeholder:"0.2",helperText:"Numeric tolerance value",sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"white"}}})})}),e.jsx(i,{size:{xs:12,sm:2},children:e.jsx(s,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",pt:1},children:e.jsx(h,{color:"error",onClick:()=>k(c),size:"small",sx:{backgroundColor:"#ffebee","&:hover":{backgroundColor:"#ffcdd2"}},children:e.jsx(f,{})})})})]})})},n.id)),0===c.length&&e.jsxs(s,{sx:{textAlign:"center",py:3,border:"1px dashed #e0e0e0",borderRadius:1,backgroundColor:"#f9f9f9"},children:[e.jsx(n,{variant:"body2",sx:{color:"#666",mb:1},children:"No columns defined for this parameter"}),e.jsx(n,{variant:"caption",sx:{color:"#999"},children:"Add columns to define specific data points within this parameter"})]})]})});ve.displayName="ParameterColumns";const ye=({control:r})=>{const t=se({control:r}),o=e=>{const s=pe.find(s=>s.value===e);return s?s.label:e};return e.jsxs(s,{children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(T,{sx:{mr:1,color:"#4caf50"}}),e.jsx(n,{variant:"h6",sx:{fontWeight:600,color:"#333"},children:"Review & Submit"})]}),e.jsxs(a,{sx:{p:3,mb:3,borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(m,{sx:{mr:1,color:"#1976d2"}}),e.jsx(n,{variant:"h6",sx:{fontWeight:600,color:"#333"},children:"Basic Information"})]}),e.jsxs(i,{container:!0,spacing:3,children:[e.jsx(i,{size:{xs:12,md:6},children:e.jsxs(s,{children:[e.jsx(n,{variant:"body2",sx:{color:"#666",mb:.5},children:"Inspection Name"}),e.jsx(n,{variant:"body1",sx:{fontWeight:500},children:t.inspectionName||"Not specified"})]})}),e.jsx(i,{size:{xs:12,md:6},children:e.jsxs(s,{children:[e.jsx(n,{variant:"body2",sx:{color:"#666",mb:.5},children:"Inspection ID"}),e.jsx(n,{variant:"body1",sx:{fontWeight:500},children:t.inspectionId||"Not specified"})]})}),e.jsx(i,{size:{xs:12,md:6},children:e.jsxs(s,{children:[e.jsx(n,{variant:"body2",sx:{color:"#666",mb:.5},children:"Type"}),e.jsx(n,{variant:"body1",sx:{fontWeight:500},children:t.type||"Not specified"})]})}),e.jsx(i,{size:{xs:12,md:6},children:e.jsxs(s,{children:[e.jsx(n,{variant:"body2",sx:{color:"#666",mb:.5},children:"Status"}),e.jsx(W,{icon:t.status?e.jsx(T,{}):e.jsx(A,{}),label:t.status?"ACTIVE":"INACTIVE",size:"small",sx:{backgroundColor:t.status?"#4caf50":"#9e9e9e",color:"white",fontSize:"0.75rem","& .MuiChip-icon":{color:"white"}}})]})}),t.notes&&e.jsxs(i,{size:{xs:12},children:[e.jsx(g,{sx:{my:2}}),e.jsxs(s,{children:[e.jsx(n,{variant:"body2",sx:{color:"#666",mb:.5},children:"Notes"}),e.jsx(a,{sx:{p:2,backgroundColor:"#f8f9fa",border:"1px solid #e9ecef",borderRadius:"8px"},children:e.jsx(n,{variant:"body1",sx:{color:"#333",lineHeight:1.6},children:t.notes})})]})]})]})]}),t.showPartImages&&t.partImages&&t.partImages.length>0&&e.jsxs(a,{sx:{p:3,mb:3,borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(M,{sx:{mr:1,color:"#1976d2"}}),e.jsxs(n,{variant:"h6",sx:{fontWeight:600,color:"#333"},children:["Part Images (",t.partImages.length,")"]})]}),e.jsx(i,{container:!0,spacing:2,children:t.partImages.map((r,a)=>e.jsx(i,{size:{xs:12,sm:6,md:4},children:e.jsx(p,{sx:{border:"1px solid #e0e0e0",borderRadius:2,boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:e.jsxs(v,{sx:{p:2},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(M,{sx:{mr:1,color:"#1976d2",fontSize:"1.2rem"}}),e.jsx(n,{variant:"subtitle2",sx:{fontWeight:600,color:"#333"},children:String(r.name)})]}),e.jsx(n,{variant:"body2",sx:{color:"#666",wordBreak:"break-all",fontSize:"0.875rem"},children:String(r.url)})]})})},a))})]}),e.jsxs(a,{sx:{p:3,mb:3,borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(c,{sx:{mr:1,color:"#1976d2"}}),e.jsxs(n,{variant:"h6",sx:{fontWeight:600,color:"#333"},children:["Inspection Parameters (",t.inspectionParameters?.length||0,")"]})]}),t.inspectionParameters&&t.inspectionParameters.length>0?t.inspectionParameters.map((r,t)=>e.jsxs($,{sx:{mb:2,border:"1px solid #e0e0e0",borderRadius:"8px !important"},children:[e.jsx(V,{expandIcon:e.jsx(j,{}),sx:{backgroundColor:"#f8f9fa",borderRadius:"8px 8px 0 0","&:hover":{backgroundColor:"#f1f3f4"}},children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[e.jsx(n,{variant:"subtitle1",sx:{fontWeight:600,mr:2,color:"#333"},children:String(r.parameterName||`Parameter ${t+1}`)}),e.jsx(W,{label:String(r.type),size:"small",variant:"outlined",sx:{mr:1,fontSize:"0.75rem"}}),Boolean(r.ctq)&&e.jsx(W,{label:"CTQ",size:"small",color:"warning",variant:"outlined",sx:{mr:1,fontSize:"0.75rem"}}),e.jsx(W,{label:o(String(r.role)),size:"small",color:"primary",variant:"outlined",sx:{fontSize:"0.75rem"}})]})}),e.jsx(q,{sx:{backgroundColor:"white",borderRadius:"0 0 8px 8px"},children:e.jsx(s,{children:e.jsxs(i,{container:!0,spacing:3,children:[e.jsx(i,{size:{xs:12,md:6},children:e.jsxs(s,{children:[e.jsx(n,{variant:"body2",sx:{color:"#666",mb:.5},children:"Specification"}),e.jsx(n,{variant:"body1",sx:{fontWeight:500},children:String(r.specification||"Not specified")})]})}),e.jsx(i,{size:{xs:12,md:6},children:e.jsxs(s,{children:[e.jsx(n,{variant:"body2",sx:{color:"#666",mb:.5},children:"Tolerance"}),e.jsx(n,{variant:"body1",sx:{fontWeight:500},children:String(r.tolerance||"Not specified")})]})}),r.columns&&r.columns.length>0?e.jsxs(i,{size:{xs:12},children:[e.jsx(g,{sx:{my:2}}),e.jsxs(s,{children:[e.jsxs(n,{variant:"body2",sx:{color:"#666",mb:1,fontWeight:600},children:["Columns (",r.columns.length,")"]}),e.jsx(O,{component:a,variant:"outlined",sx:{borderRadius:"8px"},children:e.jsxs(D,{size:"small",children:[e.jsx(E,{sx:{backgroundColor:"#f8f9fa"},children:e.jsxs(L,{children:[e.jsx(B,{sx:{fontWeight:600,color:"#333"},children:"Name"}),e.jsx(B,{sx:{fontWeight:600,color:"#333"},children:"Type"}),e.jsx(B,{sx:{fontWeight:600,color:"#333"},children:"Default Value"}),e.jsx(B,{sx:{fontWeight:600,color:"#333"},children:"Tolerance"})]})}),e.jsx(F,{children:r.columns.map((s,r)=>e.jsxs(L,{sx:{"&:hover":{backgroundColor:"#f8f9fa"}},children:[e.jsx(B,{children:String(s.name)}),e.jsx(B,{children:e.jsx(W,{label:String(s.type),size:"small",variant:"outlined",sx:{fontSize:"0.75rem"}})}),e.jsx(B,{children:String(s.defaultValue||"-")}),e.jsx(B,{children:String(s.tolerance||"-")})]},r))})]})})]})]}):null]})})})]},t)):e.jsx(n,{variant:"body2",sx:{color:"#666",textAlign:"center",py:2},children:"No inspection parameters added"})]}),e.jsxs(a,{sx:{p:3,borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(T,{sx:{mr:1,color:"#4caf50"}}),e.jsx(n,{variant:"h6",sx:{fontWeight:600,color:"#333"},children:"Summary"})]}),e.jsxs(i,{container:!0,spacing:3,children:[e.jsx(i,{size:{xs:12,sm:4},children:e.jsx(p,{sx:{p:2,textAlign:"center",backgroundColor:"#f8f9fa",border:"1px solid #e9ecef"},children:e.jsxs(v,{sx:{p:1},children:[e.jsx(n,{variant:"body2",sx:{color:"#666",mb:1},children:"Total Parameters"}),e.jsx(n,{variant:"h4",sx:{fontWeight:600,color:"#1976d2"},children:t.inspectionParameters?.length||0})]})})}),e.jsx(i,{size:{xs:12,sm:4},children:e.jsx(p,{sx:{p:2,textAlign:"center",backgroundColor:"#f8f9fa",border:"1px solid #e9ecef"},children:e.jsxs(v,{sx:{p:1},children:[e.jsx(n,{variant:"body2",sx:{color:"#666",mb:1},children:"CTQ Parameters"}),e.jsx(n,{variant:"h4",sx:{fontWeight:600,color:"#ff9800"},children:t.inspectionParameters?.filter(e=>e.ctq).length||0})]})})}),e.jsx(i,{size:{xs:12,sm:4},children:e.jsx(p,{sx:{p:2,textAlign:"center",backgroundColor:"#f8f9fa",border:"1px solid #e9ecef"},children:e.jsxs(v,{sx:{p:1},children:[e.jsx(n,{variant:"body2",sx:{color:"#666",mb:1},children:"Part Images"}),e.jsx(n,{variant:"h4",sx:{fontWeight:600,color:"#4caf50"},children:t.partImages?.length||0})]})})})]})]})]})},Ce=["Basic Information","Inspection Parameters","Review & Submit"],Ie=()=>{const r=X(),{id:i}=Z(),t=Boolean(i),[o,l]=J.useState(0),[c,x]=J.useState(null),{data:m,isLoading:p,isSuccess:h}=le({id:Number(i)},{skip:!t||!i}),[u,{isLoading:j}]=ce(),[f,{isLoading:b}]=de(),g=re({resolver:ae(fe),defaultValues:je,mode:"onChange",reValidateMode:"onChange"}),{control:v,handleSubmit:y,formState:{errors:C},reset:I,trigger:P}=g;J.useEffect(()=>{Object.keys(C).length},[C]),J.useEffect(()=>{if(t&&h&&m){const e={id:m.detail.inspection.id,inspectionName:m.detail.inspection.inspectionName,status:"ACTIVE"===m.detail.inspection.status,inspectionId:m.detail.inspection.inspectionId,type:m.detail.inspection.type,version:m.detail.inspection.version,isLatest:m.detail.inspection.isLatest,showPartImages:m.detail.inspection.showPartImages,partImages:m.detail.inspection.partImages,inspectionParameters:m.detail.inspectionParameters.map(e=>({order:e.order,parameterName:e.parameterName,specification:e.specification,tolerance:e.tolerance,type:e.type,files:e.files||{},columns:e.columns.map(e=>({name:e.name,type:e.type,defaultValue:e.defaultValue||"",tolerance:e.tolerance||""})),role:e.role,ctq:e.ctq})),createdAt:m.detail.inspection.createdAt,updatedAt:m.detail.inspection.updatedAt};I(e)}},[t,h,m,I]);return t&&p?e.jsx(s,{sx:{minHeight:"100vh"},children:e.jsxs(a,{sx:{p:4,borderRadius:2,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",mb:4},children:[e.jsx(H,{variant:"rectangular",width:80,height:36,sx:{mr:2,borderRadius:1}}),e.jsx(H,{variant:"text",width:300,height:40})]}),e.jsx(s,{sx:{mb:4},children:e.jsx(H,{variant:"rectangular",width:"100%",height:60,sx:{borderRadius:1}})}),e.jsx(s,{sx:{mb:4},children:e.jsx(H,{variant:"rectangular",width:"100%",height:400,sx:{borderRadius:1}})}),e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",pt:3,borderTop:"1px solid #e0e0e0"},children:[e.jsx(H,{variant:"rectangular",width:80,height:36,sx:{borderRadius:1}}),e.jsxs(s,{sx:{display:"flex",gap:2},children:[e.jsx(H,{variant:"rectangular",width:100,height:36,sx:{borderRadius:1}}),e.jsx(H,{variant:"rectangular",width:120,height:36,sx:{borderRadius:1}})]})]})]})}):e.jsx(ne,{...g,children:e.jsx(s,{sx:{minHeight:"100vh"},children:e.jsxs(a,{sx:{p:4,borderRadius:2,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx(s,{sx:{display:"flex",alignItems:"center",mb:4},children:e.jsx(n,{variant:"h4",sx:{fontWeight:600,color:"#333"},children:t?"Edit Inspection":"Create New Inspection"})}),c&&e.jsx(Q,{severity:"error",sx:{mb:3},children:c}),e.jsx(s,{sx:{mb:4},children:e.jsx(U,{activeStep:o,alternativeLabel:!0,children:Ce.map(s=>e.jsx(Y,{children:e.jsx(K,{children:s})},s))})}),e.jsx(s,{sx:{mb:4},children:(s=>{switch(s){case 0:return e.jsx(be,{control:v,errors:C});case 1:return e.jsx(ge,{control:v,errors:C});case 2:return e.jsx(ye,{control:v,errors:C});default:return null}})(o)}),e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",pt:3,borderTop:"1px solid #e0e0e0"},children:[e.jsx(d,{onClick:()=>{0===o?r("/inspection-master"):l(e=>e-1)},sx:{textTransform:"none"},children:"Back"}),e.jsxs(s,{sx:{display:"flex",gap:2},children:[e.jsx(d,{variant:"outlined",startIcon:e.jsx(A,{}),onClick:()=>{r("/inspection-master")},sx:{textTransform:"none"},children:"Cancel"}),o===Ce.length-1?e.jsx(d,{variant:"contained",startIcon:e.jsx(G,{}),onClick:y(async e=>{x(null);try{if(!(await P()))return void x("Please fix all validation errors before submitting");const s={inspectionName:e.inspectionName,status:e.status?"ACTIVE":"INACTIVE",inspectionId:e.inspectionId,type:e.type,version:e.version||1,isLatest:e.isLatest??!0,showPartImages:e.showPartImages??!1,partImages:e.partImages||[]},n=(e.inspectionParameters||[]).map(e=>({order:e.order,parameterName:e.parameterName,specification:e.specification,tolerance:e.tolerance?String(e.tolerance):void 0,type:e.type,files:e.files||{},columns:(e.columns||[]).map(e=>({name:e.name,type:e.type,defaultValue:e.defaultValue?String(e.defaultValue):void 0,tolerance:e.tolerance?String(e.tolerance):void 0})),role:e.role,ctq:e.ctq??!1}));if(t&&e.id){const r={id:e.id,inspection:{id:e.id,...s},inspectionParameters:n};await f(r).unwrap(),ie.fire({icon:"success",title:"Success!",text:"Inspection updated successfully",timer:2e3,showConfirmButton:!1})}else{const e={inspection:s,inspectionParameters:n};await u(e).unwrap(),ie.fire({icon:"success",title:"Success!",text:"Inspection created successfully",timer:2e3,showConfirmButton:!1})}r("/inspection-master")}catch(s){const e=s&&"object"==typeof s&&"data"in s&&s.data&&"object"==typeof s.data&&"message"in s.data?s.data.message:s&&"object"==typeof s&&"message"in s?s.message:`Failed to ${t?"update":"create"} inspection`;x(e)}}),disabled:j||b,sx:{textTransform:"none",backgroundColor:"#1976d2","&:hover":{backgroundColor:"#1565c0"}},children:j||b?"Saving...":t?"Update Inspection":"Create Inspection"}):e.jsx(d,{variant:"contained",onClick:async()=>{const e={0:["inspectionName","inspectionId","type","status","showPartImages","partImages"],1:["inspectionParameters"]}[o];if(e)try{if(await P([...e]))l(e=>e+1);else{const e=document.querySelector(".Mui-error");e&&e.scrollIntoView({behavior:"smooth",block:"center"})}}catch(s){}else l(e=>e+1)},sx:{textTransform:"none",backgroundColor:"#1976d2","&:hover":{backgroundColor:"#1565c0"}},children:"Next"})]})]})]})})})};export{Ie as default};

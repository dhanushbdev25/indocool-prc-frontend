import{j as e,I as t,a2 as a,X as s,bn as r,aN as o,bh as i,bK as l,w as n,bk as c,bl as d,a4 as p,a5 as m,d as x,y as h,Z as u,J as f,M as j,Y as g,a8 as b,ah as C,bp as v,aU as S,m as T,bq as y,ad as w,ae as z,af as I,ag as A}from"./mui-vendor-ThRJoe5u.js";import{f as k,r as N}from"./react-vendor-jVbyDP5c.js";import{T as E,C as W}from"./CatalystTableSkeleton-BjboBL1o.js";import{s as M,t as R}from"./index-BEHhMzTN.js";import"./table-vendor-Bx02c7my.js";import"./auth-vendor-BOyMHjHL.js";import"./state-vendor-BxbV2bHq.js";import"./utils-vendor-S0KZLiBE.js";import"./form-vendor-DG-ZRlco.js";import"./ui-vendor-DL_b4SbO.js";const V=()=>{const o=k();return e.jsx(t,{sx:{mb:4},children:e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1},children:[e.jsxs(t,{children:[e.jsx(a,{variant:"h3",sx:{fontWeight:600,color:"#333",mb:1,fontSize:"2rem"},children:"PRC Template Master"}),e.jsx(a,{variant:"body1",sx:{color:"#666",fontSize:"1rem",fontWeight:400},children:"Manage and configure PRC templates with sequences and inspections"})]}),e.jsx(s,{variant:"contained",startIcon:e.jsx(r,{}),onClick:()=>{o("/prc-template-master/create-prc-template")},sx:{backgroundColor:"#1976d2",color:"white",borderRadius:"8px",px:3,py:1.5,textTransform:"none",fontSize:"0.875rem",fontWeight:500,"&:hover":{backgroundColor:"#1565c0"}},children:"Add Template"})]})})},L=({headerData:s})=>{const r=[{title:"Total Templates",value:s.ACTIVE+s.NEW+s.INACTIVE,subtitle:`${s.ACTIVE} active templates`,icon:e.jsx(o,{sx:{color:"#666",fontSize:"1.5rem",opacity:.7}})},{title:"Active Templates",value:s.ACTIVE,subtitle:"Currently in use",icon:e.jsx(i,{sx:{color:"#4caf50",fontSize:"1.5rem",opacity:.8}})},{title:"New Templates",value:s.NEW,subtitle:"Recently created",icon:e.jsx(l,{sx:{color:"#2196f3",fontSize:"1.5rem",opacity:.8}})},{title:"Inactive Templates",value:s.INACTIVE,subtitle:"Not in use",icon:e.jsx(n,{sx:{color:"#f44336",fontSize:"1.5rem",opacity:.8}})}];return e.jsx(t,{sx:{display:"flex",gap:3,mb:4},children:r.map((s,r)=>e.jsx(c,{sx:{flex:1,borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",backgroundColor:"white",transition:"transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 16px rgba(0,0,0,0.15)"}},children:e.jsx(d,{sx:{p:3,position:"relative"},children:e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(t,{children:[e.jsx(a,{variant:"body2",sx:{color:"#666",mb:1,fontSize:"0.875rem",fontWeight:500},children:s.title}),e.jsx(a,{variant:"h4",sx:{fontWeight:600,color:"#333",fontSize:"2rem",mb:.5},children:s.value}),e.jsx(a,{variant:"caption",sx:{color:"#999",fontSize:"0.75rem"},children:s.subtitle})]}),e.jsx(t,{sx:{opacity:.7,transition:"opacity 0.2s ease-in-out","&:hover":{opacity:1}},children:s.icon})]})})},r))})},D=({onSearchChange:r,onFilterChange:i})=>{const[l,n]=N.useState("All Templates"),[c,d]=N.useState("");return e.jsxs(t,{sx:{backgroundColor:"white",borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",mb:3},children:[e.jsxs(t,{sx:{p:3,borderBottom:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(o,{sx:{color:"#666",mr:1,fontSize:"1.25rem"}}),e.jsx(a,{variant:"h5",sx:{fontWeight:600,color:"#333",fontSize:"1.25rem"},children:"Template Management"})]}),e.jsx(a,{variant:"body2",sx:{color:"#666",fontSize:"0.875rem"},children:"Manage and configure PRC templates with sequences and inspections"})]}),e.jsxs(t,{sx:{p:3,display:"flex",gap:2,alignItems:"center"},children:[e.jsx(p,{placeholder:"Search by Template ID or name",variant:"outlined",size:"small",value:c,onChange:e=>{const t=e.target.value;d(t),r?.(t)},InputProps:{startAdornment:e.jsx(m,{position:"start",children:e.jsx(x,{sx:{color:"#999"}})})},sx:{flex:1,"& .MuiOutlinedInput-root":{borderRadius:"8px",backgroundColor:"#fafafa","& fieldset":{borderColor:"#e0e0e0"},"&:hover fieldset":{borderColor:"#ccc"},"&.Mui-focused fieldset":{borderColor:"#1976d2"}},"& .MuiInputBase-input":{fontSize:"0.875rem",color:"#666","&::placeholder":{color:"#999",opacity:1}}}}),e.jsx(h,{direction:"row",spacing:1,children:["All Templates","ACTIVE","NEW","INACTIVE"].map(t=>e.jsx(s,{variant:l===t?"contained":"outlined",onClick:()=>(e=>{n(e),i?.(e)})(t),sx:{borderRadius:"8px",textTransform:"none",fontSize:"0.875rem",fontWeight:500,px:2,py:1,minWidth:"auto",...l===t?{backgroundColor:"#1976d2",color:"white","&:hover":{backgroundColor:"#1565c0"}}:{color:"#666",borderColor:"#e0e0e0","&:hover":{borderColor:"#ccc",backgroundColor:"#f5f5f5"}}},children:t},t))})]})]})},P=N.memo(({data:s,onActionClick:r,onEdit:l,onView:n})=>{const c=s||[],[d,p]=N.useState(null),[m,x]=N.useState(null),h=()=>{p(null),x(null)},w=e=>{switch(e){case"ACTIVE":return"#4caf50";case"NEW":return"#2196f3";default:return"#9e9e9e"}},z=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),I=N.useMemo(()=>[{accessorKey:"templateId",header:"Template ID",size:200,Cell:({row:s})=>e.jsxs(t,{children:[e.jsx(a,{variant:"body2",sx:{fontWeight:500,color:"#333",fontSize:"0.875rem"},children:s.original.templateId}),e.jsx(a,{variant:"caption",sx:{color:"#999",fontSize:"0.75rem",display:"block"},children:s.original.updatedAt?`Updated: ${z(s.original.updatedAt)}`:""}),e.jsx(u,{label:`v${s.original.version}`,size:"small",icon:e.jsx(o,{sx:{fontSize:"0.75rem"}}),sx:{backgroundColor:"#e3f2fd",color:"#1976d2",fontSize:"0.625rem",height:"20px",mt:.5}})]})},{accessorKey:"templateName",header:"Template Name",size:250,Cell:({row:s})=>e.jsxs(t,{children:[e.jsx(a,{variant:"body2",sx:{color:"#333",fontSize:"0.875rem",fontWeight:500},children:s.original.templateName}),e.jsx(a,{variant:"caption",sx:{color:"#999",fontSize:"0.75rem",display:"block",mt:.5},children:s.original.notes||"No description available"})]})},{accessorKey:"totalSteps",header:"Steps",size:100,Cell:({row:s})=>e.jsxs(t,{sx:{textAlign:"center"},children:[e.jsx(a,{variant:"h6",sx:{color:"#333",fontSize:"1.25rem",fontWeight:600},children:s.original.totalSteps}),e.jsx(a,{variant:"caption",sx:{color:"#999",fontSize:"0.75rem"},children:"steps"})]})},{accessorKey:"status",header:"Status",size:120,Cell:({row:t})=>e.jsx(u,{label:t.original.status,icon:e.jsx(i,{sx:{fontSize:"0.75rem"}}),sx:{backgroundColor:w(t.original.status),color:"white",fontSize:"0.75rem",height:"24px","& .MuiChip-icon":{color:"white"}}})},{accessorKey:"createdAt",header:"Created",size:150,Cell:({row:t})=>e.jsx(a,{variant:"body2",sx:{color:"#666",fontSize:"0.875rem"},children:t.original.createdAt?z(t.original.createdAt):"N/A"})},{id:"actions",header:"Actions",size:80,Cell:({row:a})=>e.jsx(t,{children:e.jsx(f,{size:"small",onClick:e=>((e,t)=>{p(e.currentTarget),x(t)})(e,a.original),sx:{color:"#666"},children:e.jsx(j,{})})})}],[]);return 0===c.length?e.jsxs(t,{sx:{p:4,textAlign:"center"},children:[e.jsx(a,{variant:"h6",color:"textSecondary",children:"No PRC templates found"}),e.jsx(a,{variant:"body2",color:"textSecondary",sx:{mt:1},children:"Create your first PRC template to get started"})]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{tableColumns:I,data:c}),e.jsxs(g,{anchorEl:d,open:Boolean(d),onClose:h,children:[e.jsxs(b,{onClick:()=>{m&&n&&n(m.id),h()},children:[e.jsx(C,{children:e.jsx(v,{fontSize:"small"})}),e.jsx(S,{children:"View"})]}),e.jsxs(b,{onClick:()=>{m&&l&&l(m.id),h()},children:[e.jsx(C,{children:e.jsx(T,{fontSize:"small"})}),e.jsx(S,{children:"Edit"})]}),e.jsxs(b,{onClick:()=>{m&&r&&r(m.templateId,"delete"),h()},sx:{color:"#f44336"},children:[e.jsx(C,{children:e.jsx(y,{fontSize:"small",sx:{color:"#f44336"}})}),e.jsx(S,{children:"Delete"})]})]})]})});P.displayName="PrcTemplateTable";const q=()=>{const r=k(),[o,i]=N.useState(""),[l,n]=N.useState("All Templates"),[c,d]=N.useState(!1),[p,m]=N.useState(null),{data:x,isLoading:h,refetch:u}=M(),[f,{isLoading:j}]=R(),g=N.useMemo(()=>x?x.detail.filter(e=>void 0!==e.prcTemplate.id).map(e=>({id:e.prcTemplate.id,templateId:e.prcTemplate.templateId,templateName:e.prcTemplate.templateName,status:e.prcTemplate.status,version:e.prcTemplate.version,totalSteps:e.prcTemplateSteps.length,notes:e.prcTemplate.notes,createdAt:e.prcTemplate.createdAt||"",updatedAt:e.prcTemplate.updatedAt||""})):[],[x]),b=N.useMemo(()=>{let e=g;return"All Templates"!==l&&(e=e.filter(e=>e.status===l)),o&&(e=e.filter(e=>e.templateId.toLowerCase().includes(o.toLowerCase())||e.templateName.toLowerCase().includes(o.toLowerCase()))),e},[g,l,o]),C=()=>{d(!1),m(null)};return h?e.jsxs(t,{sx:{p:3,backgroundColor:"#f5f5f5",minHeight:"100vh"},children:[e.jsx(V,{}),e.jsx(W,{})]}):e.jsxs(t,{sx:{p:3,backgroundColor:"#f5f5f5",minHeight:"100vh"},children:[e.jsx(V,{}),x&&e.jsx(L,{headerData:x.header}),e.jsx(D,{onSearchChange:e=>{i(e)},onFilterChange:e=>{n(e)}}),e.jsx(P,{data:b,onActionClick:(e,t)=>{if("delete"===t){const t=g.find(t=>t.templateId===e);t&&(m(t),d(!0))}},onEdit:e=>{r(`/prc-template-master/edit-prc-template/${e}`)},onView:e=>{r(`/prc-template-master/view-prc-template/${e}`)}}),e.jsxs(w,{open:c,onClose:C,maxWidth:"sm",fullWidth:!0,children:[e.jsx(z,{children:"Delete PRC Template"}),e.jsx(I,{children:e.jsxs(a,{children:["Are you sure you want to delete the PRC template ",e.jsx("strong",{children:p?.templateId}),"? This will set the status to INACTIVE and preserve all remaining data."]})}),e.jsxs(A,{children:[e.jsx(s,{onClick:C,disabled:j,children:"Cancel"}),e.jsx(s,{onClick:async()=>{if(p)try{const e=x?.detail.find(e=>e.prcTemplate.id===p.id);if(e){const t={prcTemplate:{id:e.prcTemplate.id,status:e.prcTemplate.status,templateId:e.prcTemplate.templateId,templateName:e.prcTemplate.templateName,notes:e.prcTemplate.notes,version:e.prcTemplate.version,isLatest:e.prcTemplate.isLatest,isActive:e.prcTemplate.isActive},prcTemplateSteps:e.prcTemplateSteps.map(e=>({version:e.version,isLatest:e.isLatest,sequence:e.sequence,stepId:e.stepId||0,type:e.type,blockCatalystMixing:e.blockCatalystMixing,requestSupervisorApproval:e.requestSupervisorApproval}))};await f(t).unwrap(),await u(),d(!1),m(null)}}catch(e){}},color:"error",variant:"contained",disabled:j,children:j?"Deleting...":"Delete Template"})]})]})]})};export{q as default};
